(function(exports){function expo(f){exports[f.name]=f}function add(){function adder(x,y){var i;for(i=0;i<x.length;i++)x[i]+=y(i)}var ret=copy(t(arguments[0])),foo;var i,j,foo,bar;for(i=1;i<arguments.length;i++){foo=t(arguments[i]);if(ret.s.length===0&&foo.s.length>0){bar=ret;ret=copy(foo);foo=bar}adder(ret.x,mkf(foo.x));if(typeof ret.y==="undefined"){if(typeof foo.y!=="undefined")ret.y=foo.y.slice(0)}else if(typeof foo.y!=="undefined")adder(ret.y,mkf(foo.y))}return ret}expo(add);function sub(){function subber(x,
y){var i;for(i=0;i<x.length;i++)x[i]-=y(i)}var ret=copy(t(arguments[0])),foo;var i,j,foo,bar;for(i=1;i<arguments.length;i++){foo=t(arguments[i]);if(ret.s.length===0&&foo.s.length>0)if(typeof ret.y==="undefined")ret=mkT(foo.s,mka(foo.x.length,ret.x[0]));else ret=mkT(foo.s,mka(foo.x.length,ret.x[0]),mka(foo.x.length,ret.y[0]));subber(ret.x,mkf(foo.x));if(typeof foo.y!=="undefined"){if(typeof ret.y==="undefined")ret.y=mka(ret.x.length,0);subber(ret.y,mkf(foo.y))}}return ret}expo(sub);function mul(){function muler(x,
y){var i;for(i=0;i<x.length;i++)x[i]*=y(i)}var ret=copy(t(arguments[0])),foo;var i,j,foo,bar,x1,y1,x2,y2,z1,z2;for(i=1;i<arguments.length;i++){foo=t(arguments[i]);if(typeof ret.y!=="undefined"||typeof foo.y!=="undefined"){x1=real(ret);y1=imag(ret);x2=real(foo);y2=imag(foo);z1=sub(mul(x1,x2),mul(y1,y2));z2=add(mul(x1,y2),mul(y1,x2));ret=mkT(z1.s,z1.x,z2.x)}else{if(ret.s.length===0&&foo.s.length>0){bar=ret;ret=copy(foo);foo=bar}muler(ret.x,mkf(foo.x))}}return ret}expo(mul);function div(){function diver(x,
y){var i;for(i=0;i<x.length;i++)x[i]/=y(i)}var ret=copy(t(arguments[0])),foo;var i,j,foo,bar,x1,y1,x2,y2,z1,z2,r;for(i=1;i<arguments.length;i++){foo=t(arguments[i]);if(typeof ret.y!=="undefined"||typeof foo.y!=="undefined"){x1=real(ret);y1=imag(ret);x2=real(foo);y2=imag(foo);r=add(mul(x2,x2),mul(y2,y2));z1=div(add(mul(x1,x2),mul(y1,y2)),r);z2=div(sub(mul(y1,x2),mul(x1,y2)),r);ret=mkT(z1.s,z1.x,z2.x)}else{if(ret.s.length===0&&foo.s.length>0)ret=mkT(foo.s,mka(foo.x.length,ret.x[0]));diver(ret.x,mkf(foo.x))}}return ret}
expo(div);var maxit=1E4;function qrit0(x){var qs=[],q,n=x.s[0],i,k,foo,idx,i0=[0],i1=[n];x=copy(x);for(i=n;i>1;i--){q=diag(rep(i,1));for(k=0;k<maxit;k++){foo=qrstep(x,q);x=foo[0];q=foo[1];if(abs(x(i-1,i-2)).x[0]<=epsilon*(abs(x(i-1,i-1)).x[0]+abs(x(i-2,i-2)).x[0])){i0[n-i+1]=i0[n-i];i1[n-i+1]=i1[n-i]-1;idx=run(i-1);x=x(idx,idx);break}if(abs(x(1,0)).x[0]<=epsilon*(abs(x(0,0)).x[0]+abs(x(1,1)).x[0])){i0[n-i+1]=i0[n-i]+1;i1[n-i+1]=i1[n-i];idx=run(1,i);x=x(idx,idx);break}}if(k===maxit)throw new Error("eig: reached maximum iteration count");
qs[n-i]=q}q=qs[0];for(i=1;i<qs.length;i++){var idx=run(i0[i],i1[i]);set(q,idx,null,dot(qs[i],q(idx,null)))}return q}function qrit(x){var qs=[],q,n=x.s[0],i,k,foo,q1,q2,i1,i2;q=diag(rep(n,1));if(n===1)return q;x=copy(x);for(k=0;k<maxit;k++){for(i=0;i<n-1;i++)if(abs(x(i+1,i)).x[0]<=epsilon*(abs(x(i,i)).x[0]+abs(x(i+1,i+1)).x[0])){i1=run(i+1);i2=run(i+1,n);q1=qrit(x(i1,i1));q2=qrit(x(i2,i2));set(q,i1,null,dot(q1,q(i1,null)));set(q,i2,null,dot(q2,q(i2,null)));return q}foo=qrstep(x,q);x=foo[0];q=foo[1]}if(k===
maxit)throw new Error("eig: reached maximum iteration count");qs[n-i]=q;return q}function ev(U){var n=U.s[0],i,U0,idx,ret=diag(rep(n,1)),b,v,nv;for(i=1;i<n;i++){idx=run(i);U0=sub(U(idx,idx),diag(rep(i,U(i,i))));b=neg(U(idx,i));v=Usolve(U0,b);nv=sqrt(add(dot(v,conj(v)),1));set(ret,idx,i,div(v,nv));set(ret,i,i,div(1,nv))}return ret}function eig(x){x=M(t(x));if(x.s[0]!==x.s[1])throw new Error("eig: matrix must be square");var y=copy(x);var foo=qrstep(y,diag(rep(x.s[0],1)));var q=qrit(foo[0]);q=dot(q,
foo[1]);var d=dot(dot(q,x),conj(transpose(q)));return{d:getDiag(d),v:dot(conj(transpose(q)),ev(d))}}expo(eig);function dot(a,b){a=t(a);b=t(b);if(isS(a)||isS(b))return mul(a,b);var i,j,m=a.s[0],x,y,ia,ib,ax,ay,bx,by;if(isV(a)){if(isV(b)){ax=a.x;bx=b.x;x=0;if(typeof a.y!=="undefined"||typeof b.y!=="undefined"){if(typeof a.y==="undefined")ia=function(i){return 0};else{ay=a.y;ia=function(i){return ay[i]}}if(typeof b.y==="undefined")ib=function(i){return 0};else{by=b.y;ib=function(i){return by[i]}}y=0;
for(i=0;i<m;i++){x+=a.x[i]*bx[i]-ia(i)*ib(i);y+=ia(i)*bx[i]+ax[i]*ib(i)}return t(x,y)}for(i=0;i<m;i++)x+=a.x[i]*b.x[i];return t(x)}M(b);if(m!==b.s[0])throw new Error("Sizes of vector a and matrix b have to match");var foo,n=b.s[1];x=[];if(typeof b.y==="undefined"&&typeof a.y==="undefined"){for(i=0;i<n;i++){foo=dot(a,b(null,i));x[i]=foo.x[0]}return mkT([n],x)}y=[];for(i=0;i<n;i++){foo=dot(a,b(null,i));x[i]=foo.x[0];y[i]=foo.y[0]}return mkT([n],x,y)}M(a);var n;if(isV(b)){n=b.s[0];if(n!==a.s[1])throw new Error("Sizes of matrix a and vector b have to match");
var foo;x=[];if(typeof b.y==="undefined"&&typeof a.y==="undefined"){for(i=0;i<m;i++){foo=dot(a(i,null),b);x[i]=foo.x[0]}return mkT([m],x)}y=[];for(i=0;i<m;i++){foo=dot(a(i,null),b);x[i]=foo.x[0];y[i]=foo.y[0]}return mkT([m],x,y)}M(b);var o=a.s[1];if(o!==b.s[0])throw new Error("Sizes of matrices a and b have to match");n=b.s[1];x=[];if(typeof a.y==="undefined"&&typeof b.y==="undefined"){for(i=0;i<m;i++)for(j=0;j<n;j++)x.push(dot(a(i,null),b(null,j)).x[0]);return mkT([m,n],x)}y=[];for(i=0;i<m;i++)for(j=
0;j<n;j++){foo=dot(a(i,null),b(null,j));x.push(foo.x[0]);y.push(foo.y[0])}return mkT([m,n],x,y)}expo(dot);function Lsolve(L,b){L=M(t(L));b=V(t(b));var n=L.s[0];if(n!==L.s[1])throw new Error("Lsolve: L must be square");if(n!==b.s[0])throw new Error("Lsolve: L and b must have matching sizes");var i,j,ret=copy(b),foo;for(i=0;i<n;i++)set(ret,i,div(sub(ret(i),dot(L(i,run(0,i)),ret(run(0,i)))),L(i,i)));return ret}expo(Lsolve);function Usolve(U,b){U=M(t(U));b=V(t(b));var n=U.s[0];if(n!==U.s[1])throw new Error("Usolve: U must be square");
if(n!==b.s[0])throw new Error("Usolve: U and b must have matching sizes");var i,j,ret=copy(b),foo;for(i=n-1;i>=0;i--)set(ret,i,div(sub(ret(i),dot(U(i,run(i+1,n)),ret(run(i+1,n)))),U(i,i)));return ret}expo(Usolve);function LUP(A){var U=copy(M(t(A)));var n=U.s[0],i,j,k,nk,nj;if(n!==U.s[1])throw new Error("LUP only works on square matrices");var L=rep(n,n,0),P=run(n),foo,idx;for(i=0;i<n;i++){k=i;nk=abs(U(k,k)).x[0];for(j=k+1;j<n;j++){nj=abs(U(j,i)).x[0];if(nj>nk){k=j;nk=nj}}foo=U(k,null);set(U,k,null,
U(i,null));set(U,i,null,foo);foo=L(k,null);set(L,k,null,L(i,null));set(L,i,null,foo);foo=P(k);set(P,k,P(i));set(P,i,foo);set(L,i,i,1);for(j=i+1;j<n;j++){foo=div(U(j,i),U(i,i));set(L,j,i,foo);set(U,j,i,0);idx=run(i+1,n);set(U,j,idx,sub(U(j,idx),mul(foo,U(i,idx))))}}return{L:L,U:U,P:P}}expo(LUP);function det(A){var Z=LUP(A),U=Z.U,P=Z.P.x,n=P.length,i,j,k,d=1,flags=[];for(i=0;i<n;i++)if(flags[i]===undefined){flags[i]=1;j=i;k=P[j];while(k!==j){flags[k]=1;k=P[k];d*=-1}}d=t(d);for(i=0;i<n;i++)d=mul(d,U(i,
i));return d}expo(det);function transpose(A){A=M(t(A));var i,j,m=A.s[0],n=A.s[1],x2=[],y2,c1,c2,x1=A.x,y1=A.y;if(typeof y1==="undefined"){for(i=0;i<m;i++){c1=i*n;c2=i;for(j=0;j<n;j++){x2[c2]=x1[c1];c1++;c2+=m}}return mkT([n,m],x2)}y2=[];for(i=0;i<m;i++){c1=i*n;c2=i;for(j=0;j<n;j++){x2[c2]=x1[c1];y2[c2]=y1[c1];c1++;c2+=m}}return mkT([n,m],x2,y2)}expo(transpose);function inv(A){var Z=LUP(A),P=Z.P,n=P.x.length,i;var ret=diag(rep(n,1))(P,null);for(i=0;i<n;i++)set(ret,null,i,Usolve(Z.U,Lsolve(Z.L,ret(null,
i))));return ret}expo(inv);function solve(A,b){var Z=LUP(A);b=V(t(b));return Usolve(Z.U,Lsolve(Z.L,b(Z.P)))}expo(solve);function tensor(a,b){a=t(a);b=t(b);var s=a.s.concat(b.s),sa=a.s,sb=b.s;var ret;if(typeof a.y==="undefined"&&typeof b.y==="undefined")return function(){var ca=0,cb=0,cr=0,ax=a.x,bx=b.x,rx=[];function f1(k){function f2(k){if(k===sb.length){rx[cr]=ax[ca]*bx[cb];cb++;cr++;return}var i;for(i=0;i<sb[k];i++)f2(k+1)}if(k===sa.length){cb=0;f2(0);ca++}else{var i;for(i=0;i<sa[k];i++)f1(k+1)}}
f1(0);return mkT(s,rx)}();var ra=real(a),ia=imag(a),rb=real(b),ib=imag(b),rr,ir;rr=sub(tensor(ra,rb),tensor(ia,ib));ir=add(tensor(ra,ib),tensor(ia,rb));return mkT(rr.s,rr.x,ir.x)}expo(tensor);function QR(A){var Q=M(copy(A)),m=Q.s[0],n=Q.s[1],R=rep(n,Q.s[1],0);var i,j,foo,bar;for(i=0;i<n;i++){foo=Q(null,i);for(j=0;j<i;j++){bar=dot(foo,conj(Q(null,j)));R(j,i,bar);foo=sub(foo,mul(bar,Q(null,j)))}bar=norm2(foo);R(i,i,bar);Q(null,i,div(foo,bar))}return{Q:Q,R:R}}expo(QR);function samev(a,b){var i;if(!(a instanceof
Array)||!(b instanceof Array))return false;if(a.length!==b.length)return false;for(i=0;i<a.length;i++){if(typeof a[i]!=="number"||typeof b[i]!=="number")return false;if(a[i]!==b[i])return false}return true}function same(x,y){x=t(x);y=t(y);var i;if(x===y)return true;if(!samev(x.s,y.s))return false;if(!samev(x.x,y.x))return false;if(typeof x.y==="undefined"){if(typeof y.y==="undefined")return true;for(i=0;i<y.y.length;i++)if(y.y[i]!==0)return false;return true}if(typeof y.y==="undefined")for(i=0;i<
x.y.length;i++)if(x.y[i]!==0)return false;return true}expo(same);function equal(x,y){x=t(x);y=t(y);if(!samev(x.s,y.s))throw new Error("equal: x and y must have the same shape");var xx=x.x,xy=x.y,yx=y.x,yy=y.y;var i,n=xx.length,ret=[];if(typeof xy==="undefined"){if(typeof yy==="undefined"){for(i=0;i<n;i++)ret[i]=xx[i]===yx[i]?1:0;return mkT([ret.length],ret)}for(i=0;i<n;i++)ret[i]=xx[i]===yx[i]&&yy[i]===0?1:0;return mkT([ret.length],ret)}if(typeof yy==="undefined"){for(i=0;i<n;i++)ret[i]=xx[i]===yx[i]&&
xy[i]===0?1:0;return mkT([ret.length],ret)}for(i=0;i<n;i++)ret[i]=xx[i]===yx[i]&&xy[i]===yy[i]?1:0;return mkT([ret.length],ret)}expo(equal);function zipbool(x,y,f){x=R(t(x));y=R(t(y));if(!samev(x.s,y.s))throw new Error("x and y must have the same shape");var i,a=x.x,b=y.x,n=a.length,ret=[];for(i=0;i<n;i++)ret[i]=f(a[i],b[i])?1:0;return mkT(x.s,ret)}function gt(x,y){return zipbool(x,y,function(a,b){return a>b})}expo(gt);function lt(x,y){return zipbool(x,y,function(a,b){return a<b})}expo(lt);function geq(x,
y){return zipbool(x,y,function(a,b){return a>=b})}expo(geq);function leq(x,y){return zipbool(x,y,function(a,b){return a<=b})}expo(leq);function not(x){x=R(t(x));return map(function(a){return a===0?1:0},null,null,x)}expo(not);function and(x,y){return zipbool(x,y,function(a,b){return a&&b})}expo(and);function or(x,y){return zipbool(x,y,function(a,b){return a||b})}expo(or);function find(x){x=V(t(x));var i,n=x.x.length,a=x.x,b=x.y,ret=[];if(typeof b==="undefined"){for(i=0;i<n;i++)if(a[i]!==0)ret.push(i);
return mkT([ret.length],ret)}for(i=0;i<n;i++)if(a[i]!==0||b[i]!==0)ret.push(i);return mkT([ret.length],ret)}expo(find);function any(x){x=t(x);var i,n=x.x.length,a=x.x,b=x.y;if(typeof b==="undefined"){for(i=0;i<n;i++)if(a[i]!==0)return true;return false}for(i=0;i<n;i++)if(a[i]!==0||b[i]!==0)return true;return false}expo(any);function all(x){x=t(x);var i,n=x.x.length,a=x.x,b=x.y;if(typeof b==="undefined"){for(i=0;i<n;i++)if(a[i]===0)return false;return true}for(i=0;i<n;i++)if(a[i]===0&&b[i]===0)return false;
return true}expo(all);function map(f,fr,fi,x){var i,p=[],q,a=x.x,b=x.y;if(typeof b==="undefined"){for(i=0;i<a.length;i++)p[i]=f(a[i]);return mkT(x.s,p)}b=x.y;q=[];for(i=0;i<a.length;i++){p[i]=fr(a[i],b[i]);q[i]=fi(a[i],b[i])}return mkT(x.s,p,q)}function exp(x){x=t(x);var e=Math.exp,c=Math.cos,s=Math.sin;return map(e,function(a,b){return e(a)*c(b)},function(a,b){return e(a)*s(b)},x)}expo(exp);function abs(z){z=t(z);var i,x=z.x,y=z.y,n=x.length,ret=[];if(typeof y==="undefined")for(i=0;i<n;i++)ret[i]=
Math.abs(x[i]);else for(i=0;i<n;i++)ret[i]=Math.sqrt(x[i]*x[i]+y[i]*y[i]);return mkT(z.s,ret)}expo(abs);function conj(z){z=t(z);if(typeof z.y==="undefined")return z;var i=neg(imag(z));return mkT(z.s,z.x,i.x)}expo(conj);function neg(z){z=t(z);return map(function(x){return-x},function(x,y){return-x},function(x,y){return-y},z)}expo(neg);function cos(z){var e=Math.exp,c=Math.cos,s=Math.sin;z=t(z);return map(c,function(x,y){return 0.5*c(x)*(e(-y)+e(y))},function(x,y){return 0.5*s(x)*(e(-y)-e(y))},z)}expo(cos);
function sin(z){var e=Math.exp,c=Math.cos,s=Math.sin;z=t(z);return map(s,function(x,y){return 0.5*s(x)*(e(-y)+e(y))},function(x,y){return 0.5*c(x)*(e(y)-e(-y))},z)}expo(sin);function log(z){var a=Math.abs,a2=Math.atan2,l=Math.log,s=Math.sqrt;z=t(z);return map(l,function(x,y){return l(s(x*x+y*y))},function(x,y){return a2(y,x)},z)}expo(log);function atan(z){var a=Math.abs,a2=Math.atan2,l=Math.log,s=Math.sqrt;z=t(z);return map(Math.atan,function(x,y){return-0.5*(a2(-x,1+y)-a2(x,1-y))},function(x,y){return 0.5*
(l(s((1+y)*(1+y)+x*x))-l(s((1-y)*(1-y)+x*x)))},z)}expo(atan);function sqrt(z){var a=Math.atan2,p=Math.pow,s=Math.sin,c=Math.cos,sq=Math.sqrt;z=t(z);var flag=false,i,j,n=z.x.length,x=[],y=[],r,th;var zx=z.x,zy=z.y;if(typeof zy==="undefined"){for(i=0;i<n;i++){if(zx[i]<0)break;x[i]=sq(zx[i])}if(i<n){for(j=0;j<i;j++)y[i]=0;for(;i<n;i++)if(zx[i]<0){y[i]=sq(-zx[i]);x[i]=0}else{x[i]=sq(zx[i]);y[i]=0}return mkT(z.s,x,y)}return mkT(z.s,x)}for(i=0;i<n;i++){th=a(zy[i],zx[i])/2;r=p(zy[i]*zy[i]+zx[i]*zx[i],0.25);
x[i]=r*c(th);y[i]=r*s(th)}return mkT(z.s,x,y)}expo(sqrt);function pow(a,b){return exp(mul(log(a),b))}expo(pow);function iz(z){var i,foo;if(typeof z.y==="undefined"){z.y=[];for(i=0;i<z.x.length;i++)z.y[i]=0}else for(i=0;i<z.x.length;i++)z.y[i]=-z.y[i];foo=z.x;z.x=z.y;z.y=foo}function acos(z){z=t(z);if(typeof z.y==="undefined")return map(Math.acos,0,0,z);var foo=copy(z);iz(foo);foo=log(add(foo,sqrt(sub(1,mul(z,z)))));iz(foo);return add(foo,Math.PI*0.5)}expo(acos);function asin(z){z=t(z);if(typeof z.y===
"undefined")return map(Math.asin,0,0,z);var foo=copy(z);iz(foo);foo=log(add(foo,sqrt(sub(1,mul(z,z)))));iz(foo);return neg(foo)}expo(asin);function atan2(z,w){z=t(z);w=t(w);if(typeof z.y!=="undefined"||typeof w.y!=="undefined")throw new Error("atan2 is defined for real tensors only");if(!samev(z.s,w.s))throw new Error("atan2: z and w must have the same size");var ret=[],i,x=z.x,n=x.length,y=w.x;for(i=0;i<n;i++)ret[i]=Math.atan2(y[i],x[i]);return mkT(z.s,ret)}expo(atan2);function tan(z){z=t(z);var a=
sin(z),b=cos(z),c=div(a,b);return div(sin(z),cos(z))}expo(tan);function round(z){var r=Math.round;return map(r,function(x,y){return r(x)},function(x,y){return r(y)},t(z))}expo(round);function ceil(z){var r=Math.ceil;return map(r,function(x,y){return r(x)},function(x,y){return r(y)},t(z))}expo(ceil);function floor(z){var r=Math.floor;return map(r,function(x,y){return r(x)},function(x,y){return r(y)},t(z))}expo(floor);function sup(z){z=R(t(z));var foo=-Infinity;var i,x=z.x,n=x.length,M=Math.max;for(i=
0;i<n;i++)foo=M(foo,x[i]);return t(foo)}expo(sup);function inf(z){z=R(t(z));var foo=Infinity;var i,x=z.x,n=x.length,M=Math.min;for(i=0;i<n;i++)foo=M(foo,x[i]);return t(foo)}expo(inf);function real(x){x=t(x);return mkT(x.s,x.x)}expo(real);function prettyPrint(x){var ret=[],stops=[],names=[];function mksvg(s,fig){var i,n,x,y,x0=fig.x0,dx=(fig.width-fig.marginLeft-fig.marginRight)/(fig.x1-fig.x0),y1=fig.y1,dy=-(fig.height-fig.marginTop-fig.marginBottom)/(fig.y1-fig.y0);switch(s.type){case "plot":ret.push('<polyline points="');
x=s.x.x;y=s.y.x;n=y.length;for(i=0;i<n;i++)ret.push((x[i]-x0)*dx+fig.marginLeft+","+((y[i]-y1)*dy+fig.marginTop)+" ");ret.push('" style="fill:none;stroke:'+s.color+";stroke-width:"+s.lineWidth.x[0]+';" />');break;case "points":x=s.x.x;y=s.y.x;n=y.length;for(i=0;i<n;i++)ret.push('<circle cx="'+((x[i]-x0)*dx+fig.marginLeft)+'" cy="'+((y[i]-y1)*dy+fig.marginTop)+'" r="'+s.radius.x[0]+'" fill="'+s.fill+'" stroke="none" />');break;default:throw new Error("prettyPrint: unknown plot type '"+s.type+"'");
}}function mkticks(fig){var i,x0=fig.x0,dx=(fig.width-fig.marginLeft-fig.marginRight)/(fig.x1-fig.x0),y0=fig.y0,dy=-(fig.height-fig.marginTop-fig.marginBottom)/(fig.y1-fig.y0),y1=fig.y1;var x=fig.xticks,y=fig.yticks,foo;for(i=0;i<x.length;i++){foo=(x[i]-x0)*dx+fig.marginLeft;ret.push('<text text-anchor="middle" x="'+foo+'" y="'+(fig.height-fig.marginBottom+20)+'">'+fmtnum(x[i])+"</text>");ret.push('<polyline points="'+foo+","+fig.marginTop+" "+foo+","+(fig.height-fig.marginBottom)+'" style="fill:none;stroke:#d0d0d0;stroke-width:1;" />')}for(i=
0;i<y.length;i++){foo=(y[i]-y1)*dy+fig.marginTop;ret.push('<text text-anchor="end" x="'+((x0-x0)*dx+fig.marginLeft-10)+'" y="'+foo+'">'+fmtnum(y[i])+"</text>");ret.push('<polyline points="'+fig.marginLeft+","+foo+" "+(fig.width-fig.marginRight)+","+foo+'" style="fill:none;stroke:#d0d0d0;stroke-width:1;" />')}}function f(name,x,depth){var y,foo;if(x===null)ret.push("null");else if(typeof x==="number")ret.push(fmtnum(x));else if(typeof x==="boolean")ret.push(x.toString());else if(typeof x==="string")ret.push('"'+
x.replace(/"/g,'"')+'"');else if(typeof x==="object"||typeof x==="function"&&isT(x)){if(typeof x.nodeType!=="undefined"&&x.nodeType>0){ret.push('"DOM object"');return}y=stops.indexOf(x);if(y>=0){ret.push(names[y]);return}stops.push(x);names.push(name);if(isT(x))if(x.s.length===0)if(typeof x.y==="undefined")ret.push("t("+fmtnum(x.x[0])+")");else ret.push("t("+fmtnum(x.x[0])+","+fmtnum(x.y[0])+")");else{if(x.s.length>1)ret.push("\n");ret.push("t(");var f0=function(z){var c=0;function f(i){if(i===x.s.length){ret.push(fmtnum(z[c]));
c++;return}var j,k;ret.push(" [");for(j=0;j<x.s[i];j++){if(j>0){ret.push(", ");if(x.s.length>1&&i<x.s.length-1){ret.push("\n");for(k=0;k<i+2;k++)ret.push("  ")}}f(i+1)}ret.push(" ]")}f(0)};f0(x.x);if(typeof x.y!=="undefined"){ret.push(",");if(x.s.length>1)ret.push("\n  ");f0(x.y)}ret.push(")")}else if(x instanceof P){x.findBoundingBox();ret.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+x.width+'" height="'+x.height+'">');mkticks(x);for(y=0;y<x.v.length;y++)mksvg(x.v[y],x);ret.push("</svg>")}else if(x instanceof
Array){ret.push("\n");for(y=0;y<depth;y++)ret.push("  ");ret.push("[ ");for(y=0;y<x.length;y++){if(y>0)ret.push(", ");f(name+"["+y+"]",x[y],depth+1)}ret.push(" ]");return}else{ret.push("{");foo=false;for(y in x)if(x.hasOwnProperty(y)){if(foo)ret.push(",");foo=true;ret.push(escape(y)+": ");f(name+"."+y,x[y],depth)}ret.push("}")}}else if(typeof x==="function")ret.push(x.toString().replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"))}f("ans",x,0);return ret.join("")}
expo(prettyPrint);function plot(){var ret;var color=["black","blue","red","green","orange","purple","brown","yellow"];if(this.__proto__!==P.prototype)ret=new P;else ret=this;var n=arguments.length,i,z,type,w;for(i=0;i<n;i++){z=arguments[i];if(typeof z.type==="undefined")type="plot";else type=z.type;switch(type){case "plot":w=process(z,[["x",function(r,z){return R(V(t(z)))},function(r){return run(r.y.x.length)}],["y",function(r,z){return R(V(t(z)))},function(r){throw new Error("plot: field y is required.");
}],["lineWidth",function(r,z){return R(S(t(z)))},t(1)],["color",function(r,z){return z},function(r,z){return color[ret.v.length%color.length]}]]);break;case "points":w=process(z,[["x",function(r,z){return R(V(t(z)))},function(r){return run(r.y.x.length)}],["y",function(r,z){return R(V(t(z)))},function(r){throw new Error("plot: field y is required.");}],["radius",function(r,z){return R(V(t(z)))},t(5)],["fill",function(r,z){return z},function(r,z){return color[ret.v.length%color.length]}]]);break;default:throw new Error("Unknown plot type "+
type);}w.type=type;ret.v.push(w)}return ret}expo(plot);function R(z){if(typeof z.y==="undefined")return z;throw new Error("tensor must be real");}function P(){this.v=[];this.axis="auto";this.x0=0;this.x1=1;this.y0=0;this.y1=1;this.width=600;this.height=400;this.marginLeft=150;this.marginRight=30;this.marginTop=10;this.marginBottom=30;this.xticks=[0,1,2,3,4,5];this.yticks=[0,1,2,3,4]}function process(z,r){var i,n=r.length,k,r0=[],check=[],foo,ret={};for(i=0;i<n;i++){r0.push(r[i][0]);check.push(false)}for(k in z)if(z.hasOwnProperty(k)&&
k!=="type"){foo=r0.indexOf(k);if(foo<0)throw new Error("plot: unrecognized field "+k);check[foo]=true;ret[k]=r[foo][1](ret,z[k])}for(i=0;i<n;i++)if(check[i]===false)if(typeof r[i][2]==="function"&&!isT(r[i][2]))ret[r[i][0]]=r[i][2](ret);else ret[r[i][0]]=r[i][2];return ret}P.prototype={plot:plot,findBoundingBox:function(){function mkticks(z0,z1,n){var dz=z1-z0,zmax=Math.max(Math.abs(z0),Math.abs(z1)),zmin=Math.min(Math.abs(z0),Math.abs(z1));var log10=function(z){return Math.log(z)/Math.log(10)};var d0=
Math.floor(log10(Math.abs(dz))-2);var d=Math.pow(10,d0);z0=Math.ceil(z0/d)*d;z1=Math.floor(z1/d)*d;var ret=[];for(i=0;i<n;i++)ret[i]=i/(n-1)*(z1-z0)+z0;return ret}var i,j,m,n=this.v.length,x,y,x0=+Infinity,x1=-Infinity,y0=+Infinity,y1=-Infinity;for(i=0;i<n;i++)switch(this.v[i].type){case "plot":case "points":x=this.v[i].x.x;y=this.v[i].y.x;m=y.length;for(j=0;j<m;j++){x0=Math.min(x0,x[j]);x1=Math.max(x1,x[j]);y0=Math.min(y0,y[j]);y1=Math.max(y1,y[j])}break}this.x0=x0;this.x1=x1;this.y0=y0;this.y1=
y1;this.xticks=mkticks(x0,x1,this.xticks.length);this.yticks=mkticks(y0,y1,this.yticks.length)}};function QP(Q,c,A,b,maxit){function simplex(A,b,c,basis,maxiter,pairs){A=M(R(t(A)));b=V(R(t(b)));c=V(R(t(c)));basis=V(R(t(basis)));var count,i,j,k,m=A.s[0],n=A.s[1],foo,all=run(m),idx,z=rep(m-1,0);if(m!==b.s[0]||n!==c.s[0])throw new Error("simplex: internal error");for(k=0;k<basis.x.length;k++){j=basis.x[k];c=sub(c,mul(c(j),A(k,null)));c(j,0)}for(count=0;count<maxiter;count++){for(j=0;j<n;j++)if(c(j).x[0]>
0&&basis.x.indexOf(pairs.x[j])===-1)break;if(j===n)return{A:A,b:b,c:c,basis:basis};k=-1;foo=Infinity;for(i=0;i<m;i++)if(A(i,j).x[0]>0&&b(i).x[0]/A(i,j).x[0]<foo){k=i;foo=b(i).x[0]/A(i,j).x[0]}if(foo===Infinity)throw new Error("simplex: minimum is -Infinity");i=k;basis(i,j);b(i,div(b(i),A(i,j)));A(i,null,div(A(i,null),A(i,j)));idx=setDiff(all,[i]);b(idx,sub(b(idx),mul(A(idx,j),b(i))));for(k=0;k<m;k++){if(k===i)continue;A(k,null,sub(A(k,null),mul(A(i,null),A(k,j))));A(k,j,0)}c=sub(c,mul(c(j),A(i,null)));
c(j,0)}throw new Error("simplex: maximum iteration count reached");}function solution(sol){var b=sol.b,basis=sol.basis;var n=sol.A.s[1],ret=rep(n,0),i;ret(basis,b);return ret}function phase1(Q,A,b,c,maxit){var m=A.s[0],n=Q.s[0],i;var X=block([2,4],Q,transpose(A),diag(rep(n,-1)),rep(n,m,0),A,rep(m,m,0),rep(m,n,0),diag(rep(m,1)));var b1=block([2],neg(c),b);var p=X.s[0],q=X.s[1];var c1=block([2],rep(q,0),rep(n+m,-1));for(i=0;i<m+n;i++)if(b1(i).x[0]<0){b1(i,neg(b1(i)));X(i,null,neg(X(i,null)))}var X1=
block([1,2],X,diag(rep(n+m,1)));var pairs=block([5],run(n+m,2*n+m),run(2*n+m,2*n+2*m),run(0,n),run(n,n+m),rep(n+m,-1));var foo=simplex(X1,b1,c1,run(X.s[1],X.s[1]+n+m),maxit,pairs);return solution(foo)}Q=M(R(t(Q)));A=M(R(t(A)));b=V(R(t(b)));c=V(R(t(c)));var m=A.s[0],n=Q.s[0];if(m!==b.s[0]||n!==A.s[1]||n!==Q.s[1]||n!==c.s[0])throw new Error("QP: Q, A, b, c must have matching sizes");if(typeof maxit==="undefined")maxit=1E4;var I=diag(rep(n,1));var Q1=block([2,2],Q,neg(Q),neg(Q),Q);var c1=block([2],c,
neg(c));var A1=block([1,2],A,neg(A));var p=Q1.s[0];var Q2=block([2,2],Q1,rep(p,m,0),rep(m,p,0),rep(m,m,0));var c2=block([2],c1,rep(m,0));var A2=block([1,2],A1,diag(rep(m,1)));var bar=phase1(Q2,A2,b,c2,maxit);return sub(bar(run(n)),bar(run(n,2*n)))}expo(QP);(function(pool,math,width,chunks,significance,overflow,startdenom){math["seedrandom"]=function seedrandom(seed,use_entropy){var key=[];var arc4;seed=mixkey(flatten(use_entropy?[seed,pool]:arguments.length?seed:[(new Date).getTime(),pool,window],
3),key);arc4=new ARC4(key);mixkey(arc4.S,pool);math["random"]=function random(){var n=arc4.g(chunks);var d=startdenom;var x=0;while(n<significance){n=(n+x)*width;d*=width;x=arc4.g(1)}while(n>=overflow){n/=2;d/=2;x>>>=1}return(n+x)/d};return seed};function ARC4(key){var t,u,me=this,keylen=key.length;var i=0,j=me.i=me.j=me.m=0;me.S=[];me.c=[];if(!keylen)key=[keylen++];while(i<width)me.S[i]=i++;for(i=0;i<width;i++){t=me.S[i];j=lowbits(j+t+key[i%keylen]);u=me.S[j];me.S[i]=u;me.S[j]=t}me.g=function getnext(count){var s=
me.S;var i=lowbits(me.i+1);var t=s[i];var j=lowbits(me.j+t);var u=s[j];s[i]=u;s[j]=t;var r=s[lowbits(t+u)];while(--count){i=lowbits(i+1);t=s[i];j=lowbits(j+t);u=s[j];s[i]=u;s[j]=t;r=r*width+s[lowbits(t+u)]}me.i=i;me.j=j;return r};me.g(width)}function flatten(obj,depth,result,prop,typ){result=[];typ=typeof obj;if(depth&&typ=="object")for(prop in obj)if(prop.indexOf("S")<5)try{result.push(flatten(obj[prop],depth-1))}catch(e){}return result.length?result:obj+(typ!="string"?"\x00":"")}function mixkey(seed,
key,smear,j){seed+="";smear=0;for(j=0;j<seed.length;j++)key[lowbits(j)]=lowbits((smear^=key[lowbits(j)]*19)+seed.charCodeAt(j));seed="";for(j in key)seed+=String.fromCharCode(key[j]);return seed}function lowbits(n){return n&width-1}startdenom=math.pow(width,chunks);significance=math.pow(2,significance);overflow=significance*2;mixkey(math.random(),pool)})([],Math,256,6,52);function union(){var foo={},bar;var n=arguments.length,i,j,m,x;for(i=0;i<n;i++){bar=R(V(t(arguments[i])));x=bar.x;m=x.length;for(j=
0;j<m;j++)foo[x[j]]=x[j]}var ret=[];for(i in foo)if(foo.hasOwnProperty(i))ret.push(foo[i]);return t(ret)}expo(union);function setDiff(x,y){if(arguments.length!==2)throw new Error("setDiff: exactly two arguments must be given");x=R(V(t(x)));y=R(V(t(y)));var ret=[],yx=y.x;var foo=x.x.filter(function(i){return yx.indexOf(i)===-1});var i;for(i in foo)if(foo.hasOwnProperty(i))ret.push(foo[i]);return t(ret)}expo(setDiff);function intersect(){var i,n=arguments.length;var foo,ret=R(V(copy(arguments[0]))).x,
z=[];for(i=1;i<n;i++){foo=R(V(t(arguments[i]))).x;ret=ret.filter(function(i){return foo.indexOf(i)!==-1})}for(i in ret)if(ret.hasOwnProperty(i))z.push(ret[i]);return t(z)}expo(intersect);function LP(A,b,c,maxit){function simplex(A,b,c,basis,maxiter){A=M(R(t(A)));b=V(R(t(b)));c=V(R(t(c)));basis=V(R(t(basis)));var count,i,j,k,m=A.s[0],n=A.s[1],foo,all=run(m),idx,z=rep(m-1,0);if(m!==b.s[0]||n!==c.s[0])throw new Error("simplex: internal error");for(k=0;k<basis.x.length;k++){j=basis.x[k];c=sub(c,mul(c(j),
A(k,null)));c(j,0)}for(count=0;count<maxiter;count++){for(j=0;j<n;j++)if(c(j).x[0]>0)break;if(j===n)return{A:A,b:b,c:c,basis:basis};k=-1;foo=Infinity;for(i=0;i<m;i++)if(A(i,j).x[0]>0&&b(i).x[0]/A(i,j).x[0]<foo){k=i;foo=b(i).x[0]/A(i,j).x[0]}if(foo===Infinity)throw new Error("simplex: minimum is -Infinity");i=k;basis(i,j);b(i,div(b(i),A(i,j)));A(i,null,div(A(i,null),A(i,j)));idx=setDiff(all,[i]);b(idx,sub(b(idx),mul(A(idx,j),b(i))));for(k=0;k<m;k++){if(k===i)continue;A(k,null,sub(A(k,null),mul(A(i,
null),A(k,j))));A(k,j,0)}c=sub(c,mul(c(j),A(i,null)));c(j,0)}throw new Error("simplex: maximum iteration count reached");}function solution(sol){var b=sol.b,basis=sol.basis;var n=sol.A.s[1],ret=rep(n,0);ret(basis,b);return ret}function phase1(A,b,maxiter){A=M(R(t(A)));b=V(R(t(b)));var i,m=A.s[0],n=A.s[1];for(i=0;i<m;i++)if(b(i).x[0]<0){A(i,null,neg(A(i,null)));b(i,neg(b(i)))}var A0=block([1,2],A,diag(rep(A.s[0],1)));var c=block([2],rep(n,0),rep(m,-1));var foo=simplex(A0,b,c,run(n,n+m),maxiter,run(n,
m+n));return{A:foo.A(null,run(n)),b:foo.b,basis:foo.basis}}function simplex1(A,b,c,maxiter){A=M(R(t(A)));b=V(R(t(b)));c=V(R(t(c)));var foo=phase1(A,b,maxiter);if(sup(foo.basis).x[0]>=A.s[1])throw new Error("simplex: no feasible solution");foo=simplex(foo.A,foo.b,c,foo.basis,maxiter);return solution(foo)}A=M(R(t(A)));b=V(R(t(b)));c=V(R(t(c)));if(typeof maxit==="undefined")maxit=1E4;var m=A.s[0],n=A.s[1],i;if(m!==b.s[0]||n!==c.s[0])throw new Error("LP: A,b,c must have matching sizes");var A0=block([1,
3],A,neg(A),diag(rep(m,1)));var c0=block([3],neg(c),c,rep(m,0));var foo=simplex1(A0,b,c0,maxit);return sub(foo(run(0,n)),foo(run(n,2*n)))}expo(LP);var epsilon;function mkeps(){epsilon=1;while(1+epsilon>1)epsilon*=0.5;epsilon*=2;exports.epsilon=epsilon}mkeps();function size(x){var ret=[];while(typeof x!=="number")if(x instanceof Array){ret.push(x.length);if(x.length===0)return ret;x=x[0]}else throw new Error("Malformed tensor");return ret}function checkTensor(x,s){function z(x,k){var i;if(k===s.length)if(typeof x===
"number")return;else throw new Error("Malformed tensor");if(!(x instanceof Array)||x.length!==s[k])throw new Error("Malformed tensor");for(i=0;i<x.length;i++)z(x[i],k+1)}z(x,0)}function mkv(x){var ret=[];function f(x){if(typeof x==="number"){ret.push(x);return}var i;for(i=0;i<x.length;i++)f(x[i])}f(x);return ret}var _digits=4,dig0=1E4;function digits(d){if(typeof d==="number"){if(d<1||Math.round(d)!=d||d>100)throw new Error("Number of digits must be an integer between 1 and 100.");_digits=d;dig0=
Math.pow(10,d)}return _digits}expo(digits);function fmtnum(x){var ret=x.toPrecision(_digits);if(x===Number(ret))ret=x.toString();while(ret.length<_digits+6)ret=ret+" ";return ret}function S(z){if(!isS(z))throw new Error("Parameter must be scalar.");return z}function run(){var a,by,b;if(arguments.length===1){a=0;by=1;b=S(t(arguments[0])).x[0]}else if(arguments.length===2){a=S(t(arguments[0])).x[0];by=1;b=S(t(arguments[1])).x[0]}else if(arguments.length===3){a=S(t(arguments[0])).x[0];by=S(t(arguments[1])).x[0];
b=S(t(arguments[2])).x[0]}else throw new Error("Incorrect number of arguments");var foo=_run(a,by,b);return mkT([foo.length],foo)}expo(run);function rep(){var s=[],i,n=arguments.length-1,sz=1,x=[],y;for(i=0;i<n;i++){s[i]=S(t(arguments[i])).x[0];sz*=s[i]}var foo=S(t(arguments[n]));var bar=foo.x[0];for(i=0;i<sz;i++)x[i]=bar;if(typeof foo.y==="undefined")return mkT(s,x);y=[];bar=foo.y[0];for(i=0;i<sz;i++)y[i]=bar;return mkT(s,x,y)}expo(rep);function V(z){if(!isV)throw new Error("Parameter must be a vector");
return z}function diag(v,o,m,n){v=t(v);if(!isM(v)){if(!isV(v))throw new Error("v must be a vector or a matrix");if(typeof v.y==="undefined")v=mkT([1,v.s[0]],v.x.slice(0));else v=mkT([1,v.s[0]],v.x.slice(0),v.y.slice(0))}var p=v.s[0],q=v.s[1];if(typeof o==="undefined")o=run(p);else{o=t(o);if(isS(o))o=mkT([1],o.x);if(!isV(o))throw new Error("o must be a vector");}if(o.s[0]!==p)throw new Error("v and o must have matching dimensions");if(typeof m==="undefined")m=q;else m=S(t(m)).x[0];if(typeof n==="undefined")n=
q;else n=S(t(n)).x[0];var i,j,k,o1,o2,i0,j0,x=v.x,y=v.y,ret;if(typeof y==="undefined")ret=rep(m,n,0);else ret=rep(m,n,t(0,0));for(i=0;i<p;i++){if(o.x[i]<0){i0=-o.x[i];j0=0}else{i0=0;j0=o.x[i]}k=Math.min(m-i0,n-j0,q);o1=i0*n+j0;o2=i*q;for(j=0;j<k;j++){ret.x[o1]=x[o2];if(typeof y!=="undefined")ret.y[o1]=y[o2];o1+=n+1;o2++}}return ret}expo(diag);function _run(a,by,b){var k,ret=[];for(k=a;k<b;k+=by)ret.push(k);return ret}var T1set=function(){if(arguments.length!==2)throw new Error("Vectors need exactly one index");
var bar=t(arguments[1]);var x0=bar.x,i,j,y0=bar.y,x1=this.x,y1=this.y,n=x1.length;var foo=arguments[0]===null?run(n):t(arguments[0]),k=foo.x;if(foo.s[0]===0)return this;if(!samev(foo.s,bar.s))throw new Error("set: indexing and value tensors must be of the same size");for(i=0;i<k.length;i++){j=k[i];if(j<0||j>=n)throw new Error("Index out of bounds");x1[j]=x0[i]}if(typeof y0==="undefined"){if(typeof y1!=="undefined")for(i=0;i<k.length;i++){j=k[i];if(j<0||j>=n)throw new Error("Index out of bounds");
y1[j]=0}}else{if(typeof y1==="undefined"){this.y=[];y1=this.y;for(i=0;i<n;i++)y1[i]=0}for(i=0;i<k.length;i++){j=k[i];if(j<0||j>=n)throw new Error("Index out of bounds");y1[j]=y0[i]}}return this};var T2$=function(z,args){if(args.length===3)return T2set.call(z,args[0],args[1],args[2]);if(args.length!==2)throw new Error("Matrices need exactly two indexes");var m=z.s[0],n=z.s[1],j,k,foo,s=[];if(args[0]===null){j=_run(0,1,m);s.push(m)}else{foo=t(args[0]);j=foo.x;if(!isS(foo))s.push(j.length)}if(args[1]===
null){k=_run(0,1,n);s.push(n)}else{foo=t(args[1]);k=foo.x;if(!isS(foo))s.push(k.length)}function f(z){var p,q,a,b,ret=[],offset;for(p=0;p<j.length;p++){a=j[p];if(a<0||a>=m)throw new Error("Index out of bounds");offset=a*n;for(q=0;q<k.length;q++){b=k[q];if(b<0||b>=n)throw new Error("Index out of bounds");ret.push(z[offset+b])}}return ret}if(typeof z.y==="undefined")return mkT(s,f(z.x));return mkT(s,f(z.x),f(z.y))};var T2set=function(){if(arguments.length!==3)throw new Error("Matrices need exactly two indexes");
var m=this.s[0],n=this.s[1];var is0=arguments[0]===null?run(m):t(arguments[0]),js0=arguments[1]===null?run(n):t(arguments[1]),vs=t(arguments[2]);var is=is0.x;var js=js0.x;var p=is.length,q=js.length,s=[];if(!isS(is0)){if(is0.s[0]===0)return this;if(!isV(is0))throw new Error("set: index must be scalar or vector");s.push(p)}if(!isS(js0)){if(js0.s[0]===0)return this;if(!isV(js0))throw new Error("set: index must be scalar or vector");s.push(q)}if(!samev(s,vs.s))throw new Error("set: indexing and value tensors must be of matching sizes");
var vx=vs.x,x=this.x;var i,j,off1,off2,count;count=0;for(i=0;i<p;i++){off1=is[i]*n;for(j=0;j<q;j++){x[off1+js[j]]=vx[count];count++}}count=0;if(typeof vs.y!=="undefined"){if(typeof this.y==="undefined")this.y=mka(x.length,0);var y=this.y,vy=vs.y;for(i=0;i<p;i++){off1=is[i]*n;for(j=0;j<q;j++){y[off1+js[j]]=vy[count];count++}}}else if(typeof this.y!=="undefined"){var y=this.y;for(i=0;i<p;i++){off1=is[i]*n;off2=i*q;for(j=0;j<q;j++)y[off1+js[j]]=0}}return this};var Tn$=function(z,args){if(args.length===
z.s.length+1)return Tnset.apply(z,args);if(args.length!==z.s.length)throw new Error("Incorrect number of indices");var s=[],k=[],i,muls=[],m0=1,s0=z.s,foo;for(i=args.length-1;i>=0;i--){if(args[i]==="null"){k[i]=_run(0,1,s0[i]);s.push(k[i].length)}else{foo=t(args[i]);k[i]=foo.x;if(!isS(foo))s.push(k[i].length)}muls[i]=m0;m0*=z.s[i]}function f(z){var ret=[];function g(i,offset){if(i===k.length){ret.push(z[offset]);return}var foo=k[i],j,l;for(j=0;j<foo.length;j++){l=foo[j];if(l<0||l>=s0[i])throw new Error("Index out of bounds");
g(i+1,offset+l*muls[i])}}g(0,0);return ret}if(typeof z.y==="undefined")return mkT(s,f(z.x));return mkT(s,f(z.x),f(z.y))};var Tnset=function(){var is=[],k,s=[],s0=this.s,n=s0.length,muls=[],mul=1,foo,an;if(arguments.length!==n+1)throw new Error("set: Incorrect number of indices");for(k=0;k<n;k++)if(arguments[k]===null)is[k]=_run(0,1,s0[k]);else{foo=t(arguments[k]);is[k]=foo.x;if(!isS(foo)){if(!isV(foo))throw new Error("set: Index must be a vector or a scalar");s.push(foo.x.length)}}an=t(arguments[n]);
if(!samev(s,an.s))throw new Error("set: indexing and size of values has to match");for(k=n-1;k>=0;k--){muls[k]=mul;mul*=s0[k]}function g(z,h){var count=0;function f(k,offset){if(k===n){z[offset]=h(count);count++;return}var i,foo=is[k],bar;for(i=0;i<is[k].length;i++){bar=foo[i];if(bar<0||bar>s0[k])throw new Error("set: Index out of bounds");f(k+1,offset+muls[k]*is[k][i])}}f(0,0)}foo=an.x;g(this.x,function(i){return foo[i]});if(typeof an.y==="undefined"){if(typeof this.y!=="undefined")g(this.x,function(i){return 0})}else{if(typeof this.y===
"undefined")this.y=mka(this.x.length);foo=an.y;g(this.y,function(i){return foo[i]})}return this};function mkT(s,x,y){var ret;function mk$($){function Tensor(){return $(Tensor,arguments)}return Tensor}if(s.length===0)return function(){function Tensor(z){if(typeof z==="undefined")return Tensor;if(typeof z==="number")z=[z];if(z instanceof Array){Tensor.x=z;if(typeof Tensor.y!=="undefined")delete Tensor.y;return Tensor}Tensor.x=z.x;if(typeof Tensor.y==="undefined"){if(typeof z.y==="undefined")return Tensor;
Tensor.y=z.y;return Tensor}if(typeof z.y==="undefined")delete Tensor.y;Tensor.y=z.y;return Tensor}Tensor.s=s;Tensor.x=x;if(typeof y!=="undefined")Tensor.y=y;return Tensor}();else if(s.length===1)return function(){function Tensor(z,w){if(typeof w!=="undefined")return T1set.call(Tensor,z,w);var s,k,n=Tensor.s[0],foo;if(z===null){k=_run(0,1,n);s=[n]}else{foo=t(z);k=foo.x;if(!isS(foo))s=[k.length];else s=[]}function f(z){var i,j,ret=[];for(i=0;i<k.length;i++){j=k[i];if(j<0||j>=n)throw new Error("Index out of bounds");
ret.push(z[j])}return ret}if(typeof Tensor.y==="undefined")return mkT(s,f(Tensor.x));return mkT(s,f(Tensor.x),f(Tensor.y))}Tensor.s=s;Tensor.x=x;if(typeof y!=="undefined")Tensor.y=y;return Tensor}();else if(s.length===2)ret=mk$(T2$);else ret=mk$(Tn$);ret.s=s;ret.x=x;if(typeof y!=="undefined")ret.y=y;return ret}function toArray(v){v=R(t(v));if(isS(v))return v.x[0];var count=0;function f(k){if(k===v.s.length)return v.x[count++];var i,ret=[];for(i=0;i<v.s[k];i++)ret[i]=f(k+1);return ret}return f(0)}
expo(toArray);function set(){var x=t(arguments[0]);if(x.s.length+2!==arguments.length)throw new Error("set: incorrect number of indices");if(x.s.length===0)return x(arguments[1]);else if(x.s.length===1)return x(arguments[1],arguments[2]);else if(x.s.length===2)return T2set.call(x,arguments[1],arguments[2],arguments[3]);else return Tnset.apply(x,Array.prototype.slice.call(arguments,1))}expo(set);function isT(x){return x.name==="Tensor"}expo(isT);function isS(x){return x.name==="Tensor"&&x.s.length===
0}expo(isS);function isV(x){return x.name==="Tensor"&&x.s.length===1}expo(isV);function isM(x){return x.name==="Tensor"&&x.s.length===2}expo(isM);function t(x,y){if(typeof t.__proto__!=="undefined"&&isT(x))return x;var sx=size(x),sy=typeof y==="undefined"?undefined:size(y),i;checkTensor(x,sx);if(typeof y!=="undefined"){checkTensor(y,sy);if(!samev(sx,sy))throw new Error("The real and imaginary parts must be tensors of the same dimensions");}if(typeof y!=="undefined")return mkT(sx,mkv(x),mkv(y));else return mkT(sx,
mkv(x))}expo(t);var i=t(0,1);exports.i=i;function copy(x){x=t(x);if(typeof x.y==="undefined")return mkT(x.s.slice(0),x.x.slice(0));return mkT(x.s.slice(0),x.x.slice(0),x.y.slice(0))}expo(copy);function mkf(x){var foo;if(x.length===1){foo=x[0];return function(i){return foo}}return function(i){return x[i]}}function mka(n,v){var ret=[],i;for(i=0;i<n;i++)ret[i]=v;return ret}function vec(v){v=t(v);if(typeof v.y==="undefined")return mkT([v.x.length],v.x);return mkT([v.x.length],v.x,v.y)}expo(vec);function reshape(v,
s){v=t(v);s=V(t(s));var m=1,i;for(i=0;i<s.x.length;i++)m*=s.x[i];if(m!==v.x.length)throw new Error("reshaped tensor must have the same number of entries as the input tensor");if(typeof v.y==="undefined")return mkT(s.x,v.x);return mkT(s.x,v.x,v.y)}expo(reshape);function M(z){if(!isM(z))throw new Error("Parameter must be a matrix");return z}function sum(v){v=t(v);var i,x0=v.x,x1=0,n=v.s[0];for(i=0;i<n;i++)x1+=x0[i];if(typeof v.y==="undefined")return mkT([],[x1]);var y0=v.y,y1=0;for(i=0;i<n;i++)y1+=
y0[i];return mkT([],[x1],[y1])}expo(sum);function prod(v){v=t(v);var i,x0=v.x,x1=1,n=v.s[0];if(typeof v.y==="undefined"){for(i=0;i<n;i++)x1*=x0[i];return mkT([],[x1])}var y0=v.y,y1=0,foo;for(i=0;i<n;i++){foo=x1*x0[i]-y1*y0[i];y1=x1*y0[i]+y1*x0[i];x1=foo}return mkT([],[x1],[y1])}expo(prod);function imag(x){x=t(x);if(typeof x.y==="undefined")return mkT(x.s,mka(x.x.length,0));return mkT(x.s,x.y)}expo(imag);function norm2(v){v=t(v);var ret=0;var i,n=v.x.length,foo=v.x;for(i=0;i<n;i++)ret+=foo[i]*foo[i];
if(typeof v.y==="undefined")return t(Math.sqrt(ret));foo=v.y;for(i=0;i<n;i++)ret+=foo[i]*foo[i];return t(Math.sqrt(ret))}expo(norm2);function house(x){x=t(x);var foo=abs(x(0)),alpha;if(foo.x[0]===0)alpha=1;else alpha=mul(div(conj(x(0)),foo),norm2(x));var v=copy(x);set(v,0,add(v(0),alpha));foo=norm2(v);if(foo.x[0]===0)foo=1;v=div(v,foo);var w=dot(conj(x),v);if(abs(w).x[0]===0)w=t(0);else w=add(div(w,conj(w)),1);return[v,w]}function shift(a,b,c,d){var disc=mul(sqrt(add(mul(sub(a,d),sub(a,d)),mul(b,
c,4))),0.5),rp=mul(add(a,d),0.5),z1=add(rp,disc),z2=sub(rp,disc);if(abs(sub(z1,d))<abs(sub(z2,d)))return z1;return z2}function qrstep(x,q){var i,j,m=x.s[0],n=x.s[1],s,foo;var idx;i=0;idx=run(i,n);foo=x(idx,i);set(foo,i,sub(foo(i),shift(x(m-2,n-2),x(m-2,n-1),x(m-1,n-2),x(m-1,n-1))));foo=house(foo);var v=foo[0],w=foo[1];set(x,idx,null,sub(x(idx,null),mul(w,tensor(v,dot(conj(v),x(idx,null))))));set(x,null,idx,sub(x(null,idx),mul(conj(w),tensor(dot(x(null,idx),v),conj(v)))));set(q,idx,null,sub(q(idx,
null),mul(w,tensor(v,dot(conj(v),q(idx,null))))));for(i=0;i<n-2;i++){for(s=m;s>0;s--)if(!same(x(s-1,i),t(0)))break;idx=run(i+1,s);foo=house(x(idx,i));v=foo[0];w=foo[1];if(w!==0){set(x,idx,null,sub(x(idx,null),mul(w,tensor(v,dot(conj(v),x(idx,null))))));set(x,null,idx,sub(x(null,idx),mul(conj(w),tensor(dot(x(null,idx),v),conj(v)))));set(q,idx,null,sub(q(idx,null),mul(w,tensor(v,dot(conj(v),q(idx,null))))));idx=run(i+2,m);set(x,idx,i,rep(m-i-2,0))}}return[x,q]}function cat(){var i,j,x=[],y,foo,fx,fy,
count;count=0;for(i=0;i<arguments.length;i++){foo=V(t(arguments[i]));fx=foo.x;if(typeof foo.y==="undefined")if(typeof y==="undefined")for(j=0;j<fx.length;j++){x[count]=fx[j];count++}else for(j=0;j<fx.length;j++){x[count]=fx[j];y[count]=0;count++}else{if(typeof y==="undefined"){y=[];for(j=0;j<x.length;j++)y[j]=0}fy=foo.y;for(j=0;j<fx.length;j++){x[count]=fx[j];y[count]=fy[j];count++}}}if(typeof y==="undefined")return mkT([count],x);return mkT([count],x,y)}expo(cat);function getDiag(z){z=M(t(z));var m=
z.s[0],n=z.s[1],p=Math.min(m,n),i,cursor=0,x=[],y,zx=z.x,zy=z.y;if(typeof zy==="undefined"){for(i=0;i<p;i++){x[i]=zx[cursor];cursor+=n+1}return mkT([p],x)}y=[];for(i=0;i<p;i++){x[i]=zx[cursor];y[i]=zy[cursor];cursor+=n+1}return mkT([p],x,y)}expo(getDiag);function random(){var s=Array.prototype.slice.apply(arguments,[0]);var i,n=1;for(i=0;i<s.length;i++)n*=s[i];var x=[];for(i=0;i<n;i++)x[i]=Math.random();return mkT(s,x)}expo(random);function lower(A,k){A=M(t(A));var i,j,m=A.s[0],n=A.s[1],ret=rep(m,
n,0);if(typeof k==="undefined")k=0;for(i=0;i<m;i++)for(j=0;j<=Math.min(i+k,n-1);j++)set(ret,i,j,A(i,j));return ret}expo(lower);function upper(A,k){A=M(t(A));var i,j,m=A.s[0],n=A.s[1],ret=rep(m,n,0);if(typeof k==="undefined")k=0;for(i=0;i<m;i++)for(j=Math.max(i+k,0);j<n;j++)set(ret,i,j,A(i,j));return ret}expo(upper);function sortVector(z){z=V(t(z));var o=[],i,x=z.x,y=z.y;for(i=0;i<z.x.length;i++)o[i]=i;o.sort(typeof z.y==="undefined"?function(a,b){return x[a]-x[b]}:function(a,b){if(x[a]>x[b])return 1;
if(x[a]<x[b])return-1;return y[a]-y[b]});return z(o)}expo(sortVector);function block(){var z=arguments;var n=z.length;var s=V(R(t(z[0])));var params=[];var count=1;var sx=s.x;var sizes=[],idx=[],total=[];var muls=[];var i,j,foo,ret,count=1;function f(k){if(k===sx.length){params[k]=z[count];ret.apply(this,params);count++;return}var i;for(i=0;i<sx[k];i++){params[k]=idx[k][i];f(k+1)}}if(prod(s).x[0]!==n-1)throw new Error("block: number of blocks must match the size");for(i=1;i<z.length;i++){z[i]=t(z[i]);
if(z[i].s.length!==z[1].s.length)throw new Error("block: all blocks must have the same tensor order");}muls[sx.length-1]=1;for(i=sx.length-1;i>0;i--)muls[i-1]=muls[i]*sx[i];for(i=0;i<sx.length;i++){sizes[i]=[];idx[i]=[];foo=0;for(j=0;j<sx[i];j++){sizes[i][j]=z[1+j*muls[i]].s[i];idx[i][j]=run(foo,foo+sizes[i][j]);foo+=sizes[i][j]}total[i]=foo}total[i]=0;ret=rep.apply(this,total);f(0);return ret}expo(block)})(typeof exports==="undefined"?this.numeric={}:exports);
